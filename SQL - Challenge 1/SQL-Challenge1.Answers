-- 1. What are the details of all cars purchased in the year 2022?

SELECT car_id, make, type,style,cost_$,purchase_date
FROM  cars JOIN sales USING (car_id)
WHERE year(purchase_date) = 2022;


-- 2. What is the total number of cars sold by each salesperson?

Select  name, count(car_id) as Cars_count
From sales JOIN salespersons
Using (salesman_id)
Group by salesman_id
Order by Cars_count desc;

-- 3. What is the total revenue generated by each salesperson?

Select salesman_id, name, sum(cost_$) As Revenue_Gen 
From cars Join sales Using(car_id) Join salespersons Using(salesman_id)
Group By salesman_id
Order By Revenue_Gen Desc;



-- 4. What are the details of the cars sold by each salesperson?

select salesman_id, name,make, type, style, cost_$,sale_id
From cars Join sales Using(car_id) Join salespersons Using(salesman_id); 


-- 5. What is the total revenue generated by each car type?

Select car_id, sum(cost_$) As Revenue
From cars Join sales Using (car_id)
Group by car_id;



-- 6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

select name,make, type, style, cost_$,sale_id,purchase_date
From cars Join sales Using(car_id) Join salespersons Using(salesman_id)
Where name = 'Emily Wong' and year(purchase_date) = 2021; 



-- 7. What is the total revenue generated by the sales of hatchback cars?

Select car_id, style, sum(cost_$) As Revenue
From cars Join sales Using (car_id)
Where style = 'hatchback'
Group by car_id ;

-- 8. What is the total revenue generated by the sales of SUV cars in the year 2022?

Select car_id, style, sum(cost_$) As Revenue
From cars Join sales Using (car_id)
Where style = 'SUV' AND year(purchase_date) = 2022
Group by car_id;

-- 9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?

Select distinct name, city, salesman_id
From salespersons Join sales
Using (salesman_id) where salesman_id = (select salesman_id from (select salesman_id, count(car_id)  as count 
from sales where year(purchase_date) =2023 group by salesman_id
order by count desc limit 1) as sales_Exe);

-- 10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?

Select distinct name, age, salesman_id
From salespersons Join sales
Using (salesman_id) where salesman_id = (select salesman_id from (select salesman_id, count(car_id)  as count 
from sales where year(purchase_date) =2022 group by salesman_id
order by count desc limit 1) as sales_Exe);
